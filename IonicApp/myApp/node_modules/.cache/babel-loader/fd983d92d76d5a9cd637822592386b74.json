{"ast":null,"code":"import { authConfig, baseUrl, getLogger, withLogs } from \"../core\";\nimport axios from 'axios';\nconst log = getLogger('trainsAPI');\nconst trainURL = `http://${baseUrl}/api/train`;\nexport const getTrains = token => {\n  return withLogs(axios.get(trainURL, authConfig(token)), 'getItems');\n};\nexport const updateTrain = (token, train) => {\n  return withLogs(axios.put(`${trainURL}/${train._id}`, train, authConfig(token)), 'updateTrain');\n};\nexport const createItem = (token, train) => {\n  return withLogs(axios.post(trainURL, train, authConfig(token)), 'createItem');\n};\nexport const newWebSocket = onMessage => {\n  const ws = new WebSocket(`ws://${baseUrl}`);\n\n  ws.onopen = () => {\n    log('WebSocket onOpen');\n  };\n\n  ws.onclose = () => {\n    log('WebSocket onClose');\n  };\n\n  ws.onerror = () => {\n    log('WebSocket onError');\n  };\n\n  ws.onmessage = messageEvent => {\n    log('WebSocket onMessage');\n    onMessage(JSON.parse(messageEvent.data));\n  };\n\n  return () => {\n    ws.close();\n  };\n};","map":{"version":3,"sources":["D:/PDM/IonicApp/myApp/src/todo/TrainsAPI.tsx"],"names":["authConfig","baseUrl","getLogger","withLogs","axios","log","trainURL","getTrains","token","get","updateTrain","train","put","_id","createItem","post","newWebSocket","onMessage","ws","WebSocket","onopen","onclose","onerror","onmessage","messageEvent","JSON","parse","data","close"],"mappings":"AAAA,SAAQA,UAAR,EAAoBC,OAApB,EAA6BC,SAA7B,EAAwCC,QAAxC,QAAyD,SAAzD;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AAGA,MAAMC,GAAG,GAAGH,SAAS,CAAC,WAAD,CAArB;AACA,MAAMI,QAAQ,GAAI,UAASL,OAAQ,YAAnC;AAEA,OAAO,MAAMM,SAAmD,GAAGC,KAAK,IAAG;AACvE,SAAOL,QAAQ,CAACC,KAAK,CAACK,GAAN,CAAUH,QAAV,EAAoBN,UAAU,CAACQ,KAAD,CAA9B,CAAD,EAAyC,UAAzC,CAAf;AACH,CAFM;AAIP,OAAO,MAAME,WAAwE,GAAG,CAACF,KAAD,EAAQG,KAAR,KAAkB;AACtG,SAAOR,QAAQ,CAACC,KAAK,CAACQ,GAAN,CAAW,GAAEN,QAAS,IAAGK,KAAK,CAACE,GAAI,EAAnC,EAAsCF,KAAtC,EAA6CX,UAAU,CAACQ,KAAD,CAAvD,CAAD,EAAkE,aAAlE,CAAf;AACH,CAFM;AAIP,OAAO,MAAMM,UAAuE,GAAG,CAACN,KAAD,EAAQG,KAAR,KAAkB;AACrG,SAAOR,QAAQ,CAACC,KAAK,CAACW,IAAN,CAAWT,QAAX,EAAqBK,KAArB,EAA4BX,UAAU,CAACQ,KAAD,CAAtC,CAAD,EAAiD,YAAjD,CAAf;AACH,CAFM;AAWP,OAAO,MAAMQ,YAAY,GAAIC,SAAD,IAA4C;AACpE,QAAMC,EAAE,GAAG,IAAIC,SAAJ,CAAe,QAAOlB,OAAQ,EAA9B,CAAX;;AACAiB,EAAAA,EAAE,CAACE,MAAH,GAAY,MAAK;AACbf,IAAAA,GAAG,CAAC,kBAAD,CAAH;AACH,GAFD;;AAGAa,EAAAA,EAAE,CAACG,OAAH,GAAa,MAAK;AACdhB,IAAAA,GAAG,CAAC,mBAAD,CAAH;AACH,GAFD;;AAGAa,EAAAA,EAAE,CAACI,OAAH,GAAa,MAAK;AACdjB,IAAAA,GAAG,CAAC,mBAAD,CAAH;AACH,GAFD;;AAGAa,EAAAA,EAAE,CAACK,SAAH,GAAeC,YAAY,IAAG;AAC1BnB,IAAAA,GAAG,CAAC,qBAAD,CAAH;AACAY,IAAAA,SAAS,CAACQ,IAAI,CAACC,KAAL,CAAWF,YAAY,CAACG,IAAxB,CAAD,CAAT;AACH,GAHD;;AAIA,SAAO,MAAM;AACTT,IAAAA,EAAE,CAACU,KAAH;AACH,GAFD;AAGH,CAlBM","sourcesContent":["import {authConfig, baseUrl, getLogger, withLogs  } from \"../core\";\r\nimport {TrainProps} from \"./TrainProps\";\r\nimport axios from 'axios';\r\n\r\n\r\nconst log = getLogger('trainsAPI');\r\nconst trainURL = `http://${baseUrl}/api/train`;\r\n\r\nexport const getTrains: (token: string) => Promise<TrainProps[]> = token =>{\r\n    return withLogs(axios.get(trainURL, authConfig(token)), 'getItems');\r\n};\r\n\r\nexport const updateTrain: (token: string, train: TrainProps) => Promise<TrainProps[]> = (token, train) => {\r\n    return withLogs(axios.put(`${trainURL}/${train._id}`, train, authConfig(token)), 'updateTrain');\r\n};\r\n\r\nexport const createItem: (token: string, train: TrainProps) => Promise<TrainProps[]> = (token, train) => {\r\n    return withLogs(axios.post(trainURL, train, authConfig(token)), 'createItem');\r\n}\r\n\r\ninterface MessageData{\r\n    event: string;\r\n    payload:{\r\n        train: TrainProps\r\n    };\r\n}\r\n\r\nexport const newWebSocket = (onMessage: (data: MessageData) => void) => {\r\n    const ws = new WebSocket(`ws://${baseUrl}`);\r\n    ws.onopen = () =>{\r\n        log('WebSocket onOpen');\r\n    }\r\n    ws.onclose = () =>{\r\n        log('WebSocket onClose');\r\n    }\r\n    ws.onerror = () =>{\r\n        log('WebSocket onError');\r\n    }\r\n    ws.onmessage = messageEvent =>{\r\n        log('WebSocket onMessage');\r\n        onMessage(JSON.parse(messageEvent.data));\r\n    };\r\n    return () => {\r\n        ws.close();\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}